{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import SearchBar from\"../SearchBar\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const Table=_ref=>{let{title,fetchUrl,columns}=_ref;const[data,setData]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(\"\");const[searchTerm,setSearchTerm]=useState(\"\");const[currentPage,setCurrentPage]=useState(1);const rowsPerPage=10;useEffect(()=>{let mounted=true;const fetchData=async function(){let showLoading=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;try{if(showLoading)setLoading(true);const res=await fetch(fetchUrl);const json=await res.json();if(!mounted)return;if(Array.isArray(json)){setData(json);setError(\"\");}else if(json&&json.error){setError(json.error);setData([]);}else{setError(\"Unexpected response from server.\");setData([]);}}catch(e){if(mounted){setError(\"Failed to fetch data.\");setData([]);}}finally{if(mounted&&showLoading)setLoading(false);}};fetchData(true);const interval=setInterval(()=>fetchData(false),30000);return()=>{mounted=false;clearInterval(interval);};},[fetchUrl]);// Helper function to determine if a value is gain/loss and apply appropriate class\nconst getValueClass=(columnKey,value)=>{if(columnKey===\"unrealized_gain_loss\"||columnKey===\"percent_change\"){const numValue=parseFloat(value);console.log(\"Column: \".concat(columnKey,\", Value: \").concat(value,\", Parsed: \").concat(numValue,\", Class: \").concat(numValue>=0?\"gain\":\"loss\"));if(!isNaN(numValue)){return numValue>=0?\"gain\":\"loss\";}}return\"\";};// Format value with proper sign and styling\nconst formatValue=(columnKey,value)=>{if(columnKey===\"unrealized_gain_loss\"||columnKey===\"percent_change\"){const numValue=parseFloat(value);if(!isNaN(numValue)){return numValue>=0?\"+\".concat(value):value;}}return value;};const filteredData=data.filter(row=>columns.some(col=>{var _row$col$key;return String((_row$col$key=row[col.key])!==null&&_row$col$key!==void 0?_row$col$key:\"\").toLowerCase().includes(searchTerm.toLowerCase());}));const totalPages=Math.max(1,Math.ceil(filteredData.length/rowsPerPage));const paginatedData=filteredData.slice((currentPage-1)*rowsPerPage,currentPage*rowsPerPage);useEffect(()=>setCurrentPage(1),[searchTerm]);return/*#__PURE__*/_jsxs(\"div\",{className:\"table-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"table-header\",children:[/*#__PURE__*/_jsx(SearchBar,{searchTerm:searchTerm,setSearchTerm:setSearchTerm}),/*#__PURE__*/_jsx(\"div\",{className:\"table-title\",children:title})]}),/*#__PURE__*/_jsx(\"div\",{className:\"table-wrapper\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsx(\"tr\",{children:columns.map((col,idx)=>/*#__PURE__*/_jsx(\"th\",{className:col.align||\"\",children:col.label},idx))})}),/*#__PURE__*/_jsx(\"tbody\",{children:loading?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:columns.length,className:\"text-center\",children:\"Loading...\"})}):error||!data.length?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:columns.length,className:\"text-center text-red-500\",children:\"Failed to fetch data\"})}):// Always render `rowsPerPage` rows\nArray.from({length:rowsPerPage}).map((_,rowIdx)=>{const row=paginatedData[rowIdx];return/*#__PURE__*/_jsx(\"tr\",{children:columns.map((col,colIdx)=>{var _row$col$key2;const value=row?(_row$col$key2=row[col.key])!==null&&_row$col$key2!==void 0?_row$col$key2:\"\":\"\";const valueClass=row?getValueClass(col.key,value):\"\";const displayValue=row?formatValue(col.key,value):\"\\u00A0\";console.log(\"Rendering cell - Column: \".concat(col.key,\", Value: \").concat(value,\", Class: \").concat(valueClass));return/*#__PURE__*/_jsx(\"td\",{className:\"\".concat(col.align||\"\",\" \").concat(valueClass).trim(),children:displayValue},colIdx);})},rowIdx);})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"pagination\",children:[/*#__PURE__*/_jsx(\"button\",{disabled:currentPage===1,onClick:()=>setCurrentPage(p=>Math.max(1,p-1)),children:\"\\u25C0\"}),/*#__PURE__*/_jsxs(\"span\",{children:[currentPage,\" / \",totalPages||1]}),/*#__PURE__*/_jsx(\"button\",{disabled:currentPage===totalPages||totalPages===0,onClick:()=>setCurrentPage(p=>Math.min(totalPages,p+1)),children:\"\\u25B6\"})]})]});};","map":{"version":3,"names":["React","useState","useEffect","SearchBar","jsx","_jsx","jsxs","_jsxs","Table","_ref","title","fetchUrl","columns","data","setData","loading","setLoading","error","setError","searchTerm","setSearchTerm","currentPage","setCurrentPage","rowsPerPage","mounted","fetchData","showLoading","arguments","length","undefined","res","fetch","json","Array","isArray","e","interval","setInterval","clearInterval","getValueClass","columnKey","value","numValue","parseFloat","console","log","concat","isNaN","formatValue","filteredData","filter","row","some","col","_row$col$key","String","key","toLowerCase","includes","totalPages","Math","max","ceil","paginatedData","slice","className","children","map","idx","align","label","colSpan","from","_","rowIdx","colIdx","_row$col$key2","valueClass","displayValue","trim","disabled","onClick","p","min"],"sources":["/Users/donaldtan/dons-website/frontend/src/components/InvestmentsComponent/Table.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport SearchBar from \"../SearchBar\";\n\nexport const Table = ({ title, fetchUrl, columns }) => {\n  const [data, setData] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(\"\");\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [currentPage, setCurrentPage] = useState(1);\n  const rowsPerPage = 10;\n\n  useEffect(() => {\n    let mounted = true;\n\n    const fetchData = async (showLoading = false) => {\n      try {\n        if (showLoading) setLoading(true);\n        const res = await fetch(fetchUrl);\n        const json = await res.json();\n        if (!mounted) return;\n        if (Array.isArray(json)) {\n          setData(json);\n          setError(\"\");\n        } else if (json && json.error) {\n          setError(json.error);\n          setData([]);\n        } else {\n          setError(\"Unexpected response from server.\");\n          setData([]);\n        }\n      } catch (e) {\n        if (mounted) {\n          setError(\"Failed to fetch data.\");\n          setData([]);\n        }\n      } finally {\n        if (mounted && showLoading) setLoading(false);\n      }\n    };\n\n    fetchData(true);\n    const interval = setInterval(() => fetchData(false), 30000);\n\n    return () => {\n      mounted = false;\n      clearInterval(interval);\n    };\n  }, [fetchUrl]);\n\n  // Helper function to determine if a value is gain/loss and apply appropriate class\n  const getValueClass = (columnKey, value) => {\n    if (\n      columnKey === \"unrealized_gain_loss\" ||\n      columnKey === \"percent_change\"\n    ) {\n      const numValue = parseFloat(value);\n      console.log(\n        `Column: ${columnKey}, Value: ${value}, Parsed: ${numValue}, Class: ${\n          numValue >= 0 ? \"gain\" : \"loss\"\n        }`\n      );\n      if (!isNaN(numValue)) {\n        return numValue >= 0 ? \"gain\" : \"loss\";\n      }\n    }\n    return \"\";\n  };\n\n  // Format value with proper sign and styling\n  const formatValue = (columnKey, value) => {\n    if (\n      columnKey === \"unrealized_gain_loss\" ||\n      columnKey === \"percent_change\"\n    ) {\n      const numValue = parseFloat(value);\n      if (!isNaN(numValue)) {\n        return numValue >= 0 ? `+${value}` : value;\n      }\n    }\n    return value;\n  };\n\n  const filteredData = data.filter((row) =>\n    columns.some((col) =>\n      String(row[col.key] ?? \"\")\n        .toLowerCase()\n        .includes(searchTerm.toLowerCase())\n    )\n  );\n\n  const totalPages = Math.max(1, Math.ceil(filteredData.length / rowsPerPage));\n  const paginatedData = filteredData.slice(\n    (currentPage - 1) * rowsPerPage,\n    currentPage * rowsPerPage\n  );\n\n  useEffect(() => setCurrentPage(1), [searchTerm]);\n\n  return (\n    <div className=\"table-container\">\n      {/* Header */}\n      <div className=\"table-header\">\n        <SearchBar searchTerm={searchTerm} setSearchTerm={setSearchTerm} />\n        <div className=\"table-title\">{title}</div>\n      </div>\n\n      {/* Table */}\n      <div className=\"table-wrapper\">\n        <table className=\"table\">\n          <thead>\n            <tr>\n              {columns.map((col, idx) => (\n                <th key={idx} className={col.align || \"\"}>\n                  {col.label}\n                </th>\n              ))}\n            </tr>\n          </thead>\n          <tbody>\n            {loading ? (\n              <tr>\n                <td colSpan={columns.length} className=\"text-center\">\n                  Loading...\n                </td>\n              </tr>\n            ) : error || !data.length ? (\n              <tr>\n                <td\n                  colSpan={columns.length}\n                  className=\"text-center text-red-500\"\n                >\n                  Failed to fetch data\n                </td>\n              </tr>\n            ) : (\n              // Always render `rowsPerPage` rows\n              Array.from({ length: rowsPerPage }).map((_, rowIdx) => {\n                const row = paginatedData[rowIdx];\n                return (\n                  <tr key={rowIdx}>\n                    {columns.map((col, colIdx) => {\n                      const value = row ? row[col.key] ?? \"\" : \"\";\n                      const valueClass = row\n                        ? getValueClass(col.key, value)\n                        : \"\";\n                      const displayValue = row\n                        ? formatValue(col.key, value)\n                        : \"\\u00A0\";\n\n                      console.log(\n                        `Rendering cell - Column: ${col.key}, Value: ${value}, Class: ${valueClass}`\n                      );\n\n                      return (\n                        <td\n                          key={colIdx}\n                          className={`${col.align || \"\"} ${valueClass}`.trim()}\n                        >\n                          {displayValue}\n                        </td>\n                      );\n                    })}\n                  </tr>\n                );\n              })\n            )}\n          </tbody>\n        </table>\n      </div>\n\n      {/* Pagination */}\n      <div className=\"pagination\">\n        <button\n          disabled={currentPage === 1}\n          onClick={() => setCurrentPage((p) => Math.max(1, p - 1))}\n        >\n          ◀\n        </button>\n        <span>\n          {currentPage} / {totalPages || 1}\n        </span>\n        <button\n          disabled={currentPage === totalPages || totalPages === 0}\n          onClick={() => setCurrentPage((p) => Math.min(totalPages, p + 1))}\n        >\n          ▶\n        </button>\n      </div>\n    </div>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}