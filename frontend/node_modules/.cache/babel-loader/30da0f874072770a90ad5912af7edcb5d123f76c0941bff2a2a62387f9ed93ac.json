{"ast":null,"code":"// src/components/InvestmentsComponent/PortfolioDiversityChart.jsx\nimport React,{useEffect,useState,useRef}from\"react\";import{ResponsiveContainer,PieChart,Pie,Cell}from\"recharts\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const DEFAULT_GRAY=\"hsl(0, 0%, 75%)\";const mapPctToGreen=(pct,minPct,maxPct)=>{if(typeof pct!==\"number\")pct=0;if(maxPct===minPct){return\"hsl(120, 65%, 45%)\";}let norm=(pct-minPct)/(maxPct-minPct);norm=Math.max(0,Math.min(1,norm));const minLightness=30;const maxLightness=80;const lightness=maxLightness-norm*(maxLightness-minLightness);const minSat=50;const maxSat=85;const saturation=minSat+norm*(maxSat-minSat);return\"hsl(120, \".concat(saturation,\"%, \").concat(lightness,\"%)\");};export const PortfolioDiversityChart=_ref=>{let{fetchUrl=\"http://127.0.0.1:5000/api/portfolio\",pollInterval=60000,othersThreshold=0.02}=_ref;const[slices,setSlices]=useState([]);const[total,setTotal]=useState(0);const[loading,setLoading]=useState(true);const[error,setError]=useState(\"\");const[activeIndex,setActiveIndex]=useState(null);const[isHovering,setIsHovering]=useState(false);const[isPressing,setIsPressing]=useState(false);const containerRef=useRef(null);const cardRef=useRef(null);const previousDataRef=useRef(null);const money=v=>new Intl.NumberFormat(\"en-US\",{style:\"currency\",currency:\"USD\"}).format(Number(v||0));const load=async()=>{try{const res=await fetch(fetchUrl);if(!res.ok)throw new Error(\"Network response was not ok\");const json=await res.json();if(!Array.isArray(json)){if(json&&json.error){setError(json.error);}else if(json&&Array.isArray(json.data)){processPositions(json.data);}else{setError(\"Unexpected response from server.\");}return;}processPositions(json);setError(\"\");}catch(e){setError(\"Failed to fetch portfolio.\");console.error(\"Portfolio fetch error:\",e);}finally{if(loading){setLoading(false);}}};const processPositions=function(){let positions=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];const normalized=positions.map(p=>{const mv=Number(p.market_value)||Number(p.quantity)*Number(p.current_price)||0;return{ticker:p.ticker||p.symbol||p.name||\"UNKNOWN\",name:p.name||p.ticker||p.symbol||\"\",market_value:Number(Number(mv).toFixed(2))};});const totalValue=normalized.reduce((s,x)=>s+x.market_value,0);if(!totalValue){setSlices([]);setTotal(0);return;}normalized.sort((a,b)=>b.market_value-a.market_value);let otherValue=0;const main=[];normalized.forEach((item,idx)=>{const pct=item.market_value/totalValue;if(pct<othersThreshold){otherValue+=item.market_value;}else{main.push({name:item.ticker,value:item.market_value,rawPct:pct,rank:idx,isOther:false});}});if(otherValue>0){main.push({name:\"Other\",value:Number(otherValue.toFixed(2)),rawPct:otherValue/totalValue,rank:main.length,isOther:true});}// Only update if data actually changed\nconst newData={slices:main,total:Number(totalValue.toFixed(2))};const currentData=JSON.stringify(previousDataRef.current);const nextData=JSON.stringify(newData);if(currentData!==nextData){setSlices(main);setTotal(Number(totalValue.toFixed(2)));previousDataRef.current=newData;}};useEffect(()=>{load();const id=setInterval(load,pollInterval);return()=>clearInterval(id);// eslint-disable-next-line react-hooks/exhaustive-deps\n},[fetchUrl,pollInterval,othersThreshold]);// Per-cell enter/leave handlers (more reliable across browsers)\nconst onCellEnter=index=>{setActiveIndex(index);setIsHovering(true);};const onCellLeave=()=>{setIsHovering(false);// If not pressing, fully clear activeIndex so slice returns to normal\nif(!isPressing){setActiveIndex(null);}};// Press handlers\nconst onCellPressStart=index=>{setActiveIndex(index);setIsPressing(true);};const onCellPressEnd=()=>{// Stop pressing and restore slice visibility\nsetIsPressing(false);// If pointer is currently hovering over a slice, keep that index; otherwise clear.\nif(!isHovering){setActiveIndex(null);}};// container leave / touchcancel fallback\nconst handleContainerLeave=()=>{setIsHovering(false);setIsPressing(false);setActiveIndex(null);};// Global cleanup for mobile: ensure releasing anywhere clears press state and activeIndex\nuseEffect(()=>{const handleGlobalUp=ev=>{// If the release happens inside the chart container, we still want to clear pressing state.\n// Always clear pressing and active index unless the pointer is still hovering (rare on mobile).\nsetIsPressing(false);if(!isHovering)setActiveIndex(null);};window.addEventListener(\"pointerup\",handleGlobalUp);window.addEventListener(\"touchend\",handleGlobalUp,{passive:true});window.addEventListener(\"touchcancel\",handleGlobalUp,{passive:true});// click fallback (some browsers)\nwindow.addEventListener(\"click\",handleGlobalUp);return()=>{window.removeEventListener(\"pointerup\",handleGlobalUp);window.removeEventListener(\"touchend\",handleGlobalUp);window.removeEventListener(\"touchcancel\",handleGlobalUp);window.removeEventListener(\"click\",handleGlobalUp);};},[isHovering]);const nonOther=slices.filter(s=>!s.isOther);const minPct=nonOther.length?Math.min(...nonOther.map(s=>s.rawPct)):0;const maxPct=nonOther.length?Math.max(...nonOther.map(s=>s.rawPct)):0;const activeSlice=activeIndex!==null?slices[activeIndex]:null;const activePercentage=activeSlice?(activeSlice.value/total*100).toFixed(1):null;if(loading){return/*#__PURE__*/_jsx(\"div\",{ref:cardRef,className:\"portfolio-chart-card\",role:\"region\",\"aria-label\":\"Portfolio diversity\",children:/*#__PURE__*/_jsx(\"div\",{className:\"chart-empty\",children:\"Loading...\"})});}if(error||!slices||slices.length===0){return/*#__PURE__*/_jsx(\"div\",{ref:cardRef,className:\"portfolio-chart-card\",role:\"region\",\"aria-label\":\"Portfolio diversity\",children:/*#__PURE__*/_jsx(\"div\",{className:\"chart-empty\",children:error||\"No holdings to display\"})});}return/*#__PURE__*/_jsx(\"div\",{ref:cardRef,className:\"portfolio-chart-card\",role:\"region\",\"aria-label\":\"Portfolio diversity\",children:/*#__PURE__*/_jsx(\"div\",{ref:containerRef,className:\"portfolio-chart-inner\",onMouseLeave:handleContainerLeave,onTouchCancel:handleContainerLeave,children:/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:\"100%\",children:/*#__PURE__*/_jsxs(PieChart,{margin:{top:0,right:0,bottom:0,left:0},children:[/*#__PURE__*/_jsx(Pie,{dataKey:\"value\",data:slices,nameKey:\"name\",cx:\"50%\",cy:\"50%\",outerRadius:\"95%\",innerRadius:\"50%\",labelLine:false,isAnimationActive:false,activeIndex:activeIndex,activeShape:{outerRadius:\"105%\"},label:_ref2=>{let{cx,cy,midAngle,innerRadius:inR,outerRadius:outR,name}=_ref2;const RADIAN=Math.PI/180;const radius=inR+(outR-inR)*0.5;const x=cx+radius*Math.cos(-midAngle*RADIAN);const y=cy+radius*Math.sin(-midAngle*RADIAN);return/*#__PURE__*/_jsx(\"text\",{x:x,y:y,fill:\"#fff\",textAnchor:\"middle\",dominantBaseline:\"central\",className:\"pie-slice-label\",style:{pointerEvents:\"none\"},children:name},\"label-\".concat(name));},children:slices.map((entry,index)=>{const fill=entry.isOther?DEFAULT_GRAY:mapPctToGreen(entry.rawPct,minPct,maxPct);return/*#__PURE__*/_jsx(Cell,{fill:fill,stroke:\"rgba(255,255,255,0.2)\",style:{outline:\"none\"}// Hover / pointer\n,onMouseEnter:()=>onCellEnter(index),onMouseLeave:()=>onCellLeave(index),onPointerEnter:()=>onCellEnter(index),onPointerLeave:()=>onCellLeave(index)// Press / touch\n,onMouseDown:()=>onCellPressStart(index),onMouseUp:onCellPressEnd,onTouchStart:()=>onCellPressStart(index),onTouchEnd:onCellPressEnd,onTouchCancel:onCellPressEnd},\"cell-\".concat(entry.name,\"-\").concat(entry.value));})}),activeSlice&&(isHovering||isPressing)&&/*#__PURE__*/_jsx(\"g\",{className:\"pie-center-group\",style:{pointerEvents:\"none\"},children:/*#__PURE__*/_jsxs(\"text\",{x:\"50%\",y:\"50%\",textAnchor:\"middle\",dominantBaseline:\"middle\",className:\"pie-center-content\",style:{pointerEvents:\"none\"},children:[/*#__PURE__*/_jsx(\"tspan\",{className:\"pie-name\",x:\"50%\",dy:\"-1em\",children:activeSlice.name}),/*#__PURE__*/_jsx(\"tspan\",{className:\"pie-value\",x:\"50%\",dy:\"1.2em\",children:money(activeSlice.value)}),/*#__PURE__*/_jsxs(\"tspan\",{className:\"pie-percentage\",x:\"50%\",dy:\"1.2em\",children:[activePercentage,\"%\"]})]})})]})})})});};export default PortfolioDiversityChart;","map":{"version":3,"names":["React","useEffect","useState","useRef","ResponsiveContainer","PieChart","Pie","Cell","jsx","_jsx","jsxs","_jsxs","DEFAULT_GRAY","mapPctToGreen","pct","minPct","maxPct","norm","Math","max","min","minLightness","maxLightness","lightness","minSat","maxSat","saturation","concat","PortfolioDiversityChart","_ref","fetchUrl","pollInterval","othersThreshold","slices","setSlices","total","setTotal","loading","setLoading","error","setError","activeIndex","setActiveIndex","isHovering","setIsHovering","isPressing","setIsPressing","containerRef","cardRef","previousDataRef","money","v","Intl","NumberFormat","style","currency","format","Number","load","res","fetch","ok","Error","json","Array","isArray","data","processPositions","e","console","positions","arguments","length","undefined","normalized","map","p","mv","market_value","quantity","current_price","ticker","symbol","name","toFixed","totalValue","reduce","s","x","sort","a","b","otherValue","main","forEach","item","idx","push","value","rawPct","rank","isOther","newData","currentData","JSON","stringify","current","nextData","id","setInterval","clearInterval","onCellEnter","index","onCellLeave","onCellPressStart","onCellPressEnd","handleContainerLeave","handleGlobalUp","ev","window","addEventListener","passive","removeEventListener","nonOther","filter","activeSlice","activePercentage","ref","className","role","children","onMouseLeave","onTouchCancel","width","height","margin","top","right","bottom","left","dataKey","nameKey","cx","cy","outerRadius","innerRadius","labelLine","isAnimationActive","activeShape","label","_ref2","midAngle","inR","outR","RADIAN","PI","radius","cos","y","sin","fill","textAnchor","dominantBaseline","pointerEvents","entry","stroke","outline","onMouseEnter","onPointerEnter","onPointerLeave","onMouseDown","onMouseUp","onTouchStart","onTouchEnd","dy"],"sources":["/Users/donaldtan/dons-website/frontend/src/components/InvestmentsComponent/PortfolioDiversityChart.js"],"sourcesContent":["// src/components/InvestmentsComponent/PortfolioDiversityChart.jsx\nimport React, { useEffect, useState, useRef } from \"react\";\nimport { ResponsiveContainer, PieChart, Pie, Cell } from \"recharts\";\nimport PropTypes from \"prop-types\";\n\nconst DEFAULT_GRAY = \"hsl(0, 0%, 75%)\";\n\nconst mapPctToGreen = (pct, minPct, maxPct) => {\n  if (typeof pct !== \"number\") pct = 0;\n  if (maxPct === minPct) {\n    return `hsl(120, 65%, 45%)`;\n  }\n\n  let norm = (pct - minPct) / (maxPct - minPct);\n  norm = Math.max(0, Math.min(1, norm));\n\n  const minLightness = 30;\n  const maxLightness = 80;\n  const lightness = maxLightness - norm * (maxLightness - minLightness);\n\n  const minSat = 50;\n  const maxSat = 85;\n  const saturation = minSat + norm * (maxSat - minSat);\n\n  return `hsl(120, ${saturation}%, ${lightness}%)`;\n};\n\nexport const PortfolioDiversityChart = ({\n  fetchUrl = \"http://127.0.0.1:5000/api/portfolio\",\n  pollInterval = 60000,\n  othersThreshold = 0.02,\n}) => {\n  const [slices, setSlices] = useState([]);\n  const [total, setTotal] = useState(0);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(\"\");\n  const [activeIndex, setActiveIndex] = useState(null);\n  const [isHovering, setIsHovering] = useState(false);\n  const [isPressing, setIsPressing] = useState(false);\n\n  const containerRef = useRef(null);\n  const cardRef = useRef(null);\n  const previousDataRef = useRef(null);\n\n  const money = (v) =>\n    new Intl.NumberFormat(\"en-US\", {\n      style: \"currency\",\n      currency: \"USD\",\n    }).format(Number(v || 0));\n\n  const load = async () => {\n    try {\n      const res = await fetch(fetchUrl);\n      if (!res.ok) throw new Error(\"Network response was not ok\");\n      const json = await res.json();\n\n      if (!Array.isArray(json)) {\n        if (json && json.error) {\n          setError(json.error);\n        } else if (json && Array.isArray(json.data)) {\n          processPositions(json.data);\n        } else {\n          setError(\"Unexpected response from server.\");\n        }\n        return;\n      }\n\n      processPositions(json);\n      setError(\"\");\n    } catch (e) {\n      setError(\"Failed to fetch portfolio.\");\n      console.error(\"Portfolio fetch error:\", e);\n    } finally {\n      if (loading) {\n        setLoading(false);\n      }\n    }\n  };\n\n  const processPositions = (positions = []) => {\n    const normalized = positions.map((p) => {\n      const mv =\n        Number(p.market_value) ||\n        Number(p.quantity) * Number(p.current_price) ||\n        0;\n      return {\n        ticker: p.ticker || p.symbol || p.name || \"UNKNOWN\",\n        name: p.name || p.ticker || p.symbol || \"\",\n        market_value: Number(Number(mv).toFixed(2)),\n      };\n    });\n\n    const totalValue = normalized.reduce((s, x) => s + x.market_value, 0);\n    if (!totalValue) {\n      setSlices([]);\n      setTotal(0);\n      return;\n    }\n\n    normalized.sort((a, b) => b.market_value - a.market_value);\n\n    let otherValue = 0;\n    const main = [];\n    normalized.forEach((item, idx) => {\n      const pct = item.market_value / totalValue;\n      if (pct < othersThreshold) {\n        otherValue += item.market_value;\n      } else {\n        main.push({\n          name: item.ticker,\n          value: item.market_value,\n          rawPct: pct,\n          rank: idx,\n          isOther: false,\n        });\n      }\n    });\n\n    if (otherValue > 0) {\n      main.push({\n        name: \"Other\",\n        value: Number(otherValue.toFixed(2)),\n        rawPct: otherValue / totalValue,\n        rank: main.length,\n        isOther: true,\n      });\n    }\n\n    // Only update if data actually changed\n    const newData = { slices: main, total: Number(totalValue.toFixed(2)) };\n    const currentData = JSON.stringify(previousDataRef.current);\n    const nextData = JSON.stringify(newData);\n\n    if (currentData !== nextData) {\n      setSlices(main);\n      setTotal(Number(totalValue.toFixed(2)));\n      previousDataRef.current = newData;\n    }\n  };\n\n  useEffect(() => {\n    load();\n    const id = setInterval(load, pollInterval);\n    return () => clearInterval(id);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [fetchUrl, pollInterval, othersThreshold]);\n\n  // Per-cell enter/leave handlers (more reliable across browsers)\n  const onCellEnter = (index) => {\n    setActiveIndex(index);\n    setIsHovering(true);\n  };\n  const onCellLeave = () => {\n    setIsHovering(false);\n    // If not pressing, fully clear activeIndex so slice returns to normal\n    if (!isPressing) {\n      setActiveIndex(null);\n    }\n  };\n\n  // Press handlers\n  const onCellPressStart = (index) => {\n    setActiveIndex(index);\n    setIsPressing(true);\n  };\n\n  const onCellPressEnd = () => {\n    // Stop pressing and restore slice visibility\n    setIsPressing(false);\n    // If pointer is currently hovering over a slice, keep that index; otherwise clear.\n    if (!isHovering) {\n      setActiveIndex(null);\n    }\n  };\n\n  // container leave / touchcancel fallback\n  const handleContainerLeave = () => {\n    setIsHovering(false);\n    setIsPressing(false);\n    setActiveIndex(null);\n  };\n\n  // Global cleanup for mobile: ensure releasing anywhere clears press state and activeIndex\n  useEffect(() => {\n    const handleGlobalUp = (ev) => {\n      // If the release happens inside the chart container, we still want to clear pressing state.\n      // Always clear pressing and active index unless the pointer is still hovering (rare on mobile).\n      setIsPressing(false);\n      if (!isHovering) setActiveIndex(null);\n    };\n\n    window.addEventListener(\"pointerup\", handleGlobalUp);\n    window.addEventListener(\"touchend\", handleGlobalUp, { passive: true });\n    window.addEventListener(\"touchcancel\", handleGlobalUp, { passive: true });\n    // click fallback (some browsers)\n    window.addEventListener(\"click\", handleGlobalUp);\n\n    return () => {\n      window.removeEventListener(\"pointerup\", handleGlobalUp);\n      window.removeEventListener(\"touchend\", handleGlobalUp);\n      window.removeEventListener(\"touchcancel\", handleGlobalUp);\n      window.removeEventListener(\"click\", handleGlobalUp);\n    };\n  }, [isHovering]);\n\n  const nonOther = slices.filter((s) => !s.isOther);\n  const minPct = nonOther.length\n    ? Math.min(...nonOther.map((s) => s.rawPct))\n    : 0;\n  const maxPct = nonOther.length\n    ? Math.max(...nonOther.map((s) => s.rawPct))\n    : 0;\n\n  const activeSlice = activeIndex !== null ? slices[activeIndex] : null;\n  const activePercentage = activeSlice\n    ? ((activeSlice.value / total) * 100).toFixed(1)\n    : null;\n\n  if (loading) {\n    return (\n      <div\n        ref={cardRef}\n        className=\"portfolio-chart-card\"\n        role=\"region\"\n        aria-label=\"Portfolio diversity\"\n      >\n        <div className=\"chart-empty\">Loading...</div>\n      </div>\n    );\n  }\n\n  if (error || !slices || slices.length === 0) {\n    return (\n      <div\n        ref={cardRef}\n        className=\"portfolio-chart-card\"\n        role=\"region\"\n        aria-label=\"Portfolio diversity\"\n      >\n        <div className=\"chart-empty\">{error || \"No holdings to display\"}</div>\n      </div>\n    );\n  }\n\n  return (\n    <div\n      ref={cardRef}\n      className=\"portfolio-chart-card\"\n      role=\"region\"\n      aria-label=\"Portfolio diversity\"\n    >\n      <div\n        ref={containerRef}\n        className=\"portfolio-chart-inner\"\n        onMouseLeave={handleContainerLeave}\n        onTouchCancel={handleContainerLeave}\n      >\n        <ResponsiveContainer width=\"100%\" height=\"100%\">\n          <PieChart margin={{ top: 0, right: 0, bottom: 0, left: 0 }}>\n            <Pie\n              dataKey=\"value\"\n              data={slices}\n              nameKey=\"name\"\n              cx=\"50%\"\n              cy=\"50%\"\n              outerRadius=\"95%\"\n              innerRadius=\"50%\"\n              labelLine={false}\n              isAnimationActive={false}\n              activeIndex={activeIndex}\n              activeShape={{ outerRadius: \"105%\" }}\n              label={({\n                cx,\n                cy,\n                midAngle,\n                innerRadius: inR,\n                outerRadius: outR,\n                name,\n              }) => {\n                const RADIAN = Math.PI / 180;\n                const radius = inR + (outR - inR) * 0.5;\n                const x = cx + radius * Math.cos(-midAngle * RADIAN);\n                const y = cy + radius * Math.sin(-midAngle * RADIAN);\n\n                return (\n                  <text\n                    x={x}\n                    y={y}\n                    fill=\"#fff\"\n                    textAnchor=\"middle\"\n                    dominantBaseline=\"central\"\n                    className=\"pie-slice-label\"\n                    key={`label-${name}`}\n                    style={{ pointerEvents: \"none\" }}\n                  >\n                    {name}\n                  </text>\n                );\n              }}\n            >\n              {slices.map((entry, index) => {\n                const fill = entry.isOther\n                  ? DEFAULT_GRAY\n                  : mapPctToGreen(entry.rawPct, minPct, maxPct);\n                return (\n                  <Cell\n                    key={`cell-${entry.name}-${entry.value}`}\n                    fill={fill}\n                    stroke=\"rgba(255,255,255,0.2)\"\n                    style={{ outline: \"none\" }}\n                    // Hover / pointer\n                    onMouseEnter={() => onCellEnter(index)}\n                    onMouseLeave={() => onCellLeave(index)}\n                    onPointerEnter={() => onCellEnter(index)}\n                    onPointerLeave={() => onCellLeave(index)}\n                    // Press / touch\n                    onMouseDown={() => onCellPressStart(index)}\n                    onMouseUp={onCellPressEnd}\n                    onTouchStart={() => onCellPressStart(index)}\n                    onTouchEnd={onCellPressEnd}\n                    onTouchCancel={onCellPressEnd}\n                  />\n                );\n              })}\n            </Pie>\n\n            {/* Center content â€” pointerEvents none so it won't intercept touches */}\n            {activeSlice && (isHovering || isPressing) && (\n              <g className=\"pie-center-group\" style={{ pointerEvents: \"none\" }}>\n                <text\n                  x=\"50%\"\n                  y=\"50%\"\n                  textAnchor=\"middle\"\n                  dominantBaseline=\"middle\"\n                  className=\"pie-center-content\"\n                  style={{ pointerEvents: \"none\" }}\n                >\n                  <tspan className=\"pie-name\" x=\"50%\" dy=\"-1em\">\n                    {activeSlice.name}\n                  </tspan>\n                  <tspan className=\"pie-value\" x=\"50%\" dy=\"1.2em\">\n                    {money(activeSlice.value)}\n                  </tspan>\n                  <tspan className=\"pie-percentage\" x=\"50%\" dy=\"1.2em\">\n                    {activePercentage}%\n                  </tspan>\n                </text>\n              </g>\n            )}\n          </PieChart>\n        </ResponsiveContainer>\n      </div>\n    </div>\n  );\n};\n\nPortfolioDiversityChart.propTypes = {\n  fetchUrl: PropTypes.string,\n  pollInterval: PropTypes.number,\n  othersThreshold: PropTypes.number,\n};\n\nexport default PortfolioDiversityChart;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}